<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>GM Ritual Dashboard</title>

<script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script src="https://unpkg.com/@walletconnect/web3modal@1.9.12/dist/index.min.js"></script>

<style>
body {
  background:#0f0f1b;
  margin:0;
  padding:20px;
  text-align:center;
  color:white;
  font-family:Arial, sans-serif;
}
button {
  padding:14px 20px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  margin:10px;
  font-size:18px;
}
#connectBtn { background:#1E5EFF; color:white; }
#disconnectBtn { background:red; display:none; }
.ritual { padding:18px 26px; border-radius:12px; font-size:20px; margin:10px; }
.gm{background:#1d7bff;}
.gn{background:#8d36ff;}
.sl{background:#333;}
</style>

</head>

<body>

<h1>GM Ritual Dashboard âš¡</h1>

<button id="connectBtn">Connect Wallet</button>
<button id="disconnectBtn">Disconnect</button>

<div style="margin-top:40px;">
  <button onclick="runRitual('GM')" class="ritual gm">GM Ritual ðŸŒž</button>
  <button onclick="runRitual('GN')" class="ritual gn">GN Ritual ðŸŒ™</button>
  <button onclick="runRitual('SLEEP')" class="ritual sl">GoSleep Ritual ðŸ˜´</button>
</div>

<script>
let provider;
let signer;
let web3Modal = new window.Web3Modal.default({
  cacheProvider: false,
  providerOptions: {
    walletconnect: {
      package: window.WalletConnectProvider.default,
      options: {
        rpc: {
          8453: "https://mainnet.base.org"
        },
      }
    }
  }
});

async function connectWallet() {
  try {
    const instance = await web3Modal.connect();
    provider = new ethers.providers.Web3Provider(instance);
    signer = provider.getSigner();
    const addr = await signer.getAddress();

    document.getElementById("connectBtn").textContent = addr.slice(0,6)+"..."+addr.slice(-4);
    document.getElementById("disconnectBtn").style.display = "inline-block";

  } catch (e) {
    alert("Failed: " + e.message);
  }
}

function disconnectWallet() {
  if (web3Modal.clearCachedProvider) web3Modal.clearCachedProvider();
  signer = null;
  provider = null;
  document.getElementById("connectBtn").textContent = "Connect Wallet";
  document.getElementById("disconnectBtn").style.display = "none";
}

function runRitual(msg) {
  if (!signer) { alert("Connect wallet first!"); return; }
  alert(msg + " ritual executed!");
}

document.getElementById("connectBtn").onclick = connectWallet;
document.getElementById("disconnectBtn").onclick = disconnectWallet;

</script>

</body>
</html>
