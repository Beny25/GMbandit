<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GMbandit Rituals</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Background Style -->
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #0033cc, #66aaff);
  color: white;
  text-align: center;
}

header {
  padding: 20px;
}

button {
  padding: 12px 20px;
  margin: 10px;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  cursor: pointer;
}

#connect-btn {
  background: rgba(255,255,255,0.2);
  color: white;
  border: 1px solid white;
}

.action-btn {
  background: #ffffff;
  color: #0033cc;
  font-weight: bold;
}
</style>

<!-- ethers.js âœ… -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

<!-- Web3Modal + WalletConnect âœ… -->
<script src="https://unpkg.com/@walletconnect/web3modal@1.9.8/dist/index.umd.min.js"></script>
<script src="https://unpkg.com/@walletconnect/web3-provider@1.7.8/dist/umd/index.min.js"></script>

</head>
<body>

<header>
  <h1>ðŸŸ¦ GMbandit Rituals</h1>
  <button id="connect-btn" onclick="connectWallet()">Connect Wallet</button>
</header>

<p>One GM, One GN, One Sleep â€” Onchain forever.</p>

<button class="action-btn" onclick="ritual('gm')">GM Ritual âš¡</button>
<button class="action-btn" onclick="ritual('gn')">GN Ritual ðŸŒ™</button>
<button class="action-btn" onclick="ritual('gosleep')">Sleep Ritual ðŸ˜´</button>

<script>
// âœ… Contract Address
const CONTRACT_ADDRESS = "0x725Ccb4ddCB715f468b301395Dfd1b1efDb5308A"; // ganti jika perlu

// âœ… ABI (versi simple)
const ABI = [
  "function gm() external payable",
  "function gn() external payable",
  "function gosleep() external payable"
];

// âœ… WalletConnect Configuration
const providerOptions = {
  walletconnect: {
    package: window.WalletConnectProvider.default,
    options: {
      rpc: {
        8453: "https://mainnet.base.org"
      }
    }
  }
};

// âœ… Web3Modal Init
const web3Modal = new window.Web3Modal.default({
  cacheProvider: false,
  providerOptions,
  theme: "dark"
});

let provider;
let signer;

// âœ… Connect Wallet
async function connectWallet() {
  try {
    const instance = await web3Modal.connect();
    provider = new ethers.providers.Web3Provider(instance);
    signer = provider.getSigner();

    const addr = await signer.getAddress();
    document.getElementById("connect-btn").innerText =
      addr.substring(0, 6) + "..." + addr.slice(-4);

  } catch (err) {
    alert("Wallet connection failed!");
  }
}

// âœ… Ritual Interaction
async function ritual(type) {
  if (!signer) return alert("Connect wallet first âœ…");

  try {
    const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

    let tx;
    const ritualFee = ethers.utils.parseEther("0.00000033");

    if (type === "gm") tx = await contract.gm({ value: ritualFee });
    if (type === "gn") tx = await contract.gn({ value: ritualFee });
    if (type === "gosleep") tx = await contract.gosleep({ value: ritualFee });

    alert("Transaction sent! Hash: " + tx.hash);

    await tx.wait();
    alert("âœ… Ritual success!");

  } catch (err) {
    alert("Transaction failed: " + err.message);
  }
}

</script>

</body>
</html>
