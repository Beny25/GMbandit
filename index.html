<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GMbandit ‚Ä¢ Onchain Rituals</title>

<style>
  body {
    margin: 0;
    padding: 0;
    background: linear-gradient(180deg, #e8f1ff, #ffffff);
    font-family: Arial, sans-serif;
    color: #000;
    text-align: center;
  }

  h1 {
    margin-top: 40px;
    font-size: 32px;
    font-weight: 700;
  }

  .container {
    max-width: 400px;
    margin: auto;
    padding: 20px;
  }

  button {
    width: 100%;
    padding: 14px;
    margin: 10px 0;
    background: #ffffff;
    border: 2px solid #d0d0d0;
    border-radius: 8px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.2s ease-in-out;
  }

  button:hover {
    background: #f2f2f2;
  }

  #status {
    margin-top: 20px;
    font-size: 16px;
    padding: 12px;
  }

  input {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border: 2px solid #d0d0d0;
    border-radius: 8px;
    font-size: 16px;
  }
</style>
</head>

<body>

<h1>GMbandit ‚Ä¢ Rituals Onchain</h1>

<div class="container">

  <button id="connect">Connect Wallet</button>

  <button onclick="ritual('GM! ‚òÄÔ∏è')">GM Ritual</button>
  <button onclick="ritual('GN! üåô')">GN Ritual</button>
  <button onclick="ritual('Go Sleep üò¥')">GoSleep Ritual</button>

  <input type="text" id="customMsg" placeholder="Write your message...">
  <button onclick="ritualCustom()">Send Custom Ritual</button>

  <button onclick="deployNew()">Deploy Your Contract</button>

  <div id="status"></div>

</div>

<script type="module">
  import { ethers } from "https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.1/ethers.min.js";

  let provider;
  let signer;

  const contractAddress = "0x725Ccb4ddCB715f468b301395Dfd1b1efDb5308A"; // ‚úÖ GMbanditV2

  const abi = [
    "function performRitual(string newMessage) payable",
    "function fee() view returns (uint256)"
  ];

  document.getElementById("connect").onclick = async function () {
    if (!window.ethereum) {
      alert("Install wallet first!");
      return;
    }
    await ethereum.request({ method: "eth_requestAccounts" });
    provider = new ethers.BrowserProvider(window.ethereum);
    signer = await provider.getSigner();
    document.getElementById("status").innerHTML = "‚úÖ Wallet Connected";
  };

  async function ritual(msg) {
    if (!signer) return alert("Connect wallet first!");

    const contract = new ethers.Contract(contractAddress, abi, signer);
    const fee = await contract.fee();

    const tx = await contract.performRitual(msg, { value: fee });
    document.getElementById("status").innerHTML = "‚è≥ Sending ritual...";

    await tx.wait();
    document.getElementById("status").innerHTML = "‚úÖ Ritual complete!";
  }

  async function ritualCustom() {
    const msg = document.getElementById("customMsg").value;
    if (!msg) return alert("Write something!");
    ritual(msg);
  }

  async function deployNew() {
    window.location.href = "https://basescan.org/address/0xb9C0b964E223D0058cdFEB445B4506415117b055";
  }

</script>

</body>
</html>
