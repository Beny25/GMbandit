<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GM Ritual Dashboard âš¡</title>

<script src="https://unpkg.com/@web3modal/html@2.7.1"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
body {
    background: #000;
    color: white;
    text-align: center;
    font-family: Arial;
    padding: 20px;
}
button {
    width: 90%;
    padding: 15px;
    border-radius: 12px;
    border: none;
    margin: 10px;
    font-size: 20px;
    font-weight: bold;
}
</style>
</head>

<body>

<h1>GM Ritual Dashboard âš¡</h1>

<!-- âœ… manual connect button -->
<button id="connectBtn" style="background:#0a84ff;">Connect Wallet</button>

<button id="gmBtn">GM Ritual ðŸŒž</button>
<button id="gnBtn" style="background:#aa55ff;">GN Ritual ðŸŒ™</button>
<button id="sleepBtn" style="background:#444;">GoSleep Ritual ðŸ˜´</button>

<p><a href="/deploy" style="color:skyblue;">Deploy your contract ðŸš€</a></p>

<script>

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
// 1. CONFIG WEB3MODAL (NEW VERSION)
// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

const projectId = "e9ab1ec848b29cf2e7b9f4d2a5f92f73"; // demo id
let modal; // supaya bisa diakses global

const metadata = {
    name: "GMbandit",
    description: "GM Ritual Dapp",
    url: "https://gm-bandit.vercel.app",
    icons: ["https://gm-bandit.vercel.app/icon.png"]
};

const chains = [{
    chainId: 8453,
    name: "Base",
    currency: "ETH",
    explorerUrl: "https://basescan.org",
    rpcUrl: "https://mainnet.base.org"
}];

modal = new Web3Modal({ projectId, chains, metadata });

let providerInstance = null;

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
// 2. CONNECT FUNCTION (manual button)
// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

async function connectWallet() {
    try {
        await modal.open(); // launch modal wallet

        const walletProvider = await modal.getWalletProvider();

        if (!walletProvider) {
            alert("No wallet selected");
            return;
        }

        providerInstance = new ethers.providers.Web3Provider(walletProvider);
        const signer = providerInstance.getSigner();
        const addr = await signer.getAddress();

        // update text
        document.getElementById("connectBtn").innerHTML = "âœ… " + addr.substring(0,6) + "..." + addr.substring(addr.length-4);

    } catch (err) {
        alert("Connect error: " + err.message);
    }
}

document.getElementById("connectBtn").onclick = connectWallet;


// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
// 3. RITUAL FUNCTIONS
// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

async function performRitual(type) {
    if (!providerInstance) {
        alert("Please connect wallet first!");
        return;
    }

    const network = await providerInstance.getNetwork();
    if (network.chainId !== 8453) {
        alert("Please switch to Base Mainnet first!");
        return;
    }

    alert(type + " ritual executed (simulation)");
}

document.getElementById("gmBtn").onclick = () => performRitual("GM");
document.getElementById("gnBtn").onclick = () => performRitual("GN");
document.getElementById("sleepBtn").onclick = () => performRitual("GoSleep");

</script>

</body>
</html>
